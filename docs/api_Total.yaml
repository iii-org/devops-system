openapi: 3.0.0
info:
  title: DevOps Front End API 
  description: >-
    Optional multiline or single-line description in
    [CommonMark](http://commonmark.org/help/) or HTML.
  version: DevOps Dev Version V1
servers:
  - url: 'http://10.50.1.56:31850'
    description: 'Optional server description, e.g. Main (production) server'
tags:
  - name: project
    description: Redmine project
  - name: issues
    description: Redmine issues 
  - name: pipelines
    description: CICD pipeline ID
  - name: user
    description: user account information
  - name: repository
    description: GitLab Repository 
paths:
  /user/login:
    post:
      tags:
        - 'user'
      summary: 使用者登入
      operationId: userLogin
      requestBody:
        description: User Login Method
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
              required:
                - username
                - password
      responses:
        '200':
          description: "successful operation"
          headers:
            X-Rate-Limit:
              schema:
                type: integer
              description: "calls per hour allowed by the user"
            X-Expires-After:
              schema:
                type: integer
              description: "date in UTC when token expires"
        '400':
          description: "Invalid username/password supplied"
  /user/forgetPassword:
    post:
      tags:
        - user
      summary: 使用者忘記帳號密碼
      operationId: userForgetPassword
      requestBody:
        description: User forget password
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                mail:
                  type: string
                user_account:
                  type: string
              required:
                - mail
                - user_account
      responses:
        '200':
          description: "Success Reset Password"
  /user/{user_id}:
    get:
      summary: 取得用戶資訊
      operationId: getUserInformation
      tags:
        - user
      parameters:
        - name: user_id
          in: path
          required: true
          description: 'User PK'
          schema:
            $ref: '#/components/schemas/User'
      responses:
        '200':
          description: OK
    put:
      summary: 修改用戶資訊
      tags:
        - user
      parameters:
        - name: user_id
          in: path
          required: true
          description: 'User PK'
          schema:
            $ref: '#/components/schemas/User'
      responses:
        '200':
          description: OK
          
  /project:
    get:
      summary: 取得目前所有專案ID
      tags: 
          - 'project'
      description: ''
      responses:
        '200':    # status code
          description: A JSON array of user names
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Project'
  /project/{user_account}:
    get:
      summary: 取得使用者目前專案資訊
      tags: 
        - 'project'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: user_account
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of project object
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/ProjectList'
  /project/{project_id}/issues:
    get:
      summary: 取得專案內issues的ID
      tags: 
        - 'issues'
      description: ''
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Issues'
  /issues:
    get:
      summary: Returns a list of issues ID
      tags: 
        - 'issues'
      description: ''
      responses:
        '200':    # status code
          description: A JSON array of issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Id'
    post:
      summary: 建立Issues
      tags: 
        - 'issues'
      description: ''
      requestBody:
        description: XML建立議題
        required: true
        content:
          application/xml:
            schema:
              $ref: '#/components/schemas/AddIssue'
      responses:
        '200':    # status code
          description: "successful create issues"
  /issues/{issue_id}:
    get:
      summary: 取得Issues內的資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: issue_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Issues'
    put:
      summary: 更新Issues內的資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: issue_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Issues'
    delete:
      summary: 刪除Issues
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: issue_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: "delete successful"
  /issues/{issue_id}/function:
    get:
      summary: 取得Issues內的功能(API)的ID
      tags: 
        - 'issues'
      description: issues內所開發的功能.
      parameters:
        - name: issue_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of function id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Id'
  /funtion/{funtion_id}:
    get:
      summary: 取得Issues內功能資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: funtion_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Function'
    put:
      summary: 更新Issues內的資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: funtion_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Issues'
    delete:
      summary: 刪除Issues
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: funtion_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: "delete successful"
  /issues/{issue_id}/{funtion_id}/parameters:
    get:
      summary: 取得Issues內的功能(API)
      tags: 
        - 'issues'
      description: issues內所開發的功能所使用的參數
      parameters:
        - name: issue_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
        - name: funtion_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of function id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Id'
  /parameters/{parameters_id}:
    get:
      summary: 取得Issues內功能資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: parameters_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Parameters'
    put:
      summary: 更新Issues內的資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: parameters_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues id
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Parameters'
    delete:
      summary: 刪除Issues
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: parameters_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: "delete successful"
    
  /issues_status:
    get:
      summary: 取得目前議題可使用狀態
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/IssuesStatus'
  /issues_priority:
    get:
      summary: 取得目前議題可使用優先級別
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/IssuesPriority'
  /issuses_category/{project_id}:
    get:
      summary: 取得目前議題可使用狀態
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/IssuesCategories'
  /issues_by_user/{user_account}:
    get:
      summary: 取得使用者所擁有Issues的資訊
      tags: 
        - 'issues'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: user_account
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/Issues'
  /dashboard_issues_priority/{user_account}:
    get:
      summary: 取得使用者儀錶板資訊(工作等級)
      tags: 
        - 'DashBoard'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: user_account
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/IssuesPriorityNumber'
  /dashboard_issues_project/{user_account}:
    get:
      summary: 取得使用者儀錶板資訊(工作專案)
      tags: 
        - 'DashBoard'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: user_account
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/IssuesProjectNumber'
  /dashboard_issues_type/{user_account}:
    get:
      summary: 取得使用者儀錶板資訊(工作專案)
      tags: 
        - 'DashBoard'
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: user_account
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Id'
      responses:
        '200':    # status code
          description: A JSON array of Issues Information
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/IssuesTypeNumber'
    
components:
  schemas:
    Project:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
          source:
            type: string
            description: "Remdmin or GitLab"
    Id:
      type: array
      items:
        type: integer
    ProjectList:
      type: array
      items:
        type: object
        properties:
          name:
            type: string
            description: 專案名稱
          issues:
            type: integer
            description: 工作項目
          next_d_time:
            type: string
            format: date-time
            description: 最近交付期限
          branch:
            type: integer
            description: 分支數量
          last_test_time:
            type: string
            format: date-time
            description: 最近測試時間
          last_test_result:
            type: object
            properties:
              total:
                type: integer
                description: 總共測試數目
              success:
                type: integer
                description: 總共成功數目
    AddIssue:
      type: object
      properties:
        project_id:
          type: integer
        subject::
          type: string
        tracker_id:
          type: integer
    IssuesCategories:
      type: array
      items:
        type: object
        properties:
          id: 
            type: integer
          name:
            type: string
            description : 類別名稱
    IssuesPriority:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
          name: 
            description: 優先級別名稱
            type: string
          is_closed:
            description: 是否停用
            type: boolean
    IssuesStatus:
      type: array
      items:
        type: object
        properties:
          id: 
            type: integer
          name: 
            type: string
          is_closed: 
            type: boolean
    IssuesPriorityNumber:
      type: array
      items:
        type: object
        properties:
          name: 
            description: "優先級別名稱"
            type: string
          number:
            description: "數目"
            type: integer
    IssuesProjectNumber:
      type: array
      items:
        type: object
        properties:
          name: 
            description: "專案名稱"
            type: string
          number:
            description: "數目"
            type: integer
    IssuesTypeNumber:
      type: array
      items:
        type: object
        properties:
          name: 
            description: "議題類型"
            type: string
          number:
            description: "數目"
            type: integer

    User:
      type: object
      properties:
        id:
          type: integer
          description: "User Key"
        name:
          type: string
          description: "使用者姓名"
        username:
          type: string
          description: "使用者帳號"
        password:
          type: string
          format: password
          description: '密碼'
        email:
          type: string
          description: "使用者電子郵件信箱"
        created_at:
          type: string
          format: date-time
          description: "建立時間"
        updated_at:
          type: string
          format: date-time
          description: "更新時間"
        group:
          type: object
          properties:
            name:
              type: string
              description: '群組名稱'
        role:
          type: object
          properties:
            nname:
              type: string
              description: '角色名稱'
              
    Issues:
      type: object
      properties:
        id:
          type: integer
        project:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
        tracker:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string              
        status:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string    
        priority:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string          
        author:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string        
        subject:
          type: string
        start_date:
          type: string   
        done_ratio:
          type: integer
        custom_fields:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              name:
                type: string  
              value:
                type: string 
    Function:
      type: object
      description: "依據議題所設計的功能"
      properties:
        id:
          type: integer
        name:
          type: string
        description:
          type: string
        function_type:
          type: string
        isssues_id:
          type: integer
        parameters:
          type: array
          description: "功能內參數"
          items:
            type: object
            properties: 
              id: 
                type: integer
              name:
                type: string
              description:
                type: string
    Parameters:
        type: object
        description: "參數"
        properties:
          id:
            type: integer
          name:
            type: string
          is_defined:
            type: boolean
          description:
            type: string
          type:
            type: string
            description: 參數類別
          length:
            type: integer
          limit:
            type: string
            description: 正規表達式的限制
          values:
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                value:
                  type: string
                is_check:
                  type: boolean
